<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="jp.pcaie.mapper.MCustomerMapper">
    
    <select id="fetchBean" resultType="CustomerBean">
        SELECT 
            customer.ID AS id,
            customer.NAME AS name,
            customer.KANA AS kana,
            customer.EMAIL AS email,
            customer.TEL AS tel
        FROM
            m_customer customer
        <where>
            <if test="name != null">
            AND customer.name = #{name}
            </if>
            <if test="kana != null">
            AND customer.KANA = #{kana}
            </if>
            <if test="email != null">
            AND customer.EMAIL = #{email}
            </if>
            <if test="tel != null">
            AND customer.TEL = #{tel}
            </if>
            AND customer.DEL_FLG = '0'
        </where>
    </select>

    <insert id="insert" useGeneratedKeys="true">
        INSERT INTO m_customer (
            name
        ,   kana
        ,   contact_by
        ,   email
        ,   tel
        ,   zip_code
        ,   address
        ,   employment
        ,   department
        ) VALUES (
            #{name}
        ,   #{kana}
        ,   #{contactBy}
        ,   #{email}
        ,   #{tel}
        ,   #{zipCode}
        ,   #{address}
        ,   #{employment}
        ,   #{department}
        )
        <selectKey resultType="int" keyProperty="id" order="AFTER">
            SELECT @@IDENTITY
        </selectKey>
    </insert>

</mapper>